# 第八章 函数探幽

## 本章内容：

+ 内联函数

+ 引用变量

+ 如何按引用传递函数参数

+ 默认参数

+ 函数重载

+ 函数模板

+ 函数模板具体化



## C++内联函数

1. 内联函数是C++为提高程序运行速度所做的一项改进。

2. 常规函数和内联函数的主要区别：C++编译器如何将它们组合到程序中

3. 编译过程的最终产品是可执行程序——由一组机器语言指令组成。运行程序时，操作系统将这些指令载入到计算机内存中，因此每条指令都有特定的内存地址。计算机随后将逐步执行这些指令。有时(如有循环或分支语句时)，将跳过一些指令，向前或向后跳到特定地址。常规函数调用也使程序跳到另一个地址（函数地址），并在函数结束时返回。

4. 执行到函数调用指令时，程序将在函数调用后立即存储该指令的内存地址，并将函数参数复制到堆栈(为此保留的内存块)，跳到标记函数起点的内存单元，执行函数代码（也许还需将返回值放入到寄存器中），然后跳回到地址被保存的指令处。来回跳跃并记录跳跃位置意味着以前使用函数时，需要一定的开销。

5. 内联函数的编译代码与其他程序代码“内联”起来，即编译器将使用相应的函数代码替换函数调用。程序无需跳到另一个位置处执行代码，再跳回来。因此内联函数的运行速度比常规函数稍快，代价是占用更多的内存。

6. 如果程序在10个不同的地方调用同一个内联函数，则该程序将包含该函数代码的10个副本。

7. 应有选择地使用内联函数。
   
   + 若函数代码的时间比处理函数调用机制的时间长，则节省的时间将只占整个过程的很小一部分。
   
   + 若代码执行时间很短，则内联调用就可以节省非内联调用使用的大部分时间。另一方面，由于这个过程相当快，因此尽管节省了该过程的大部分时间，但节省的时间绝对值并不大，除非该函数经常被调用。

8. 要使用这项特性，必须采取下述措施之一：
   
   + 在函数声明钱加上关键字**inline**
   
   + 在函数定义前加上关键字**inline**

9. 通常做法是省略原型，将整个定义（即函数头和所有函数代码）放在本应提供原型的地方

10. 程序员请求将函数作为内联函数时，编译器并不一定会满足这种要求。它可能认为该函数过大或注意到函数调用了自己(内联函数不能递归)

11. 注意整个函数定义都放在一行中，但并不一定非得这样做。然而，如果函数定义占用多行（假定没有使用冗长的标识符）,则将其作为内联函数就不太合适

12. 内联函数和常规函数一样，也是按值传递参数的。

> 内联和宏
> 
> C语言使用预处理器语句#define 来提供宏——内联代码的原始实现。而是通过文本替换来实现的。
> 
> 例如下面是一个计算平方的宏：
> 
> #define SQUARE(X） X*X
> 
> a = SQUARE(5.0); is replaced by a = 5.0 * 5.0;
> 
> b = SQUARE(4.5 + 7.5); is replaced by b = 4.5 + 7.5 *  4.5 + 7.5;
> 
> d = SQUARE(c++); is replaced by d = c++ * c++;
> 
> 上述示例只有第一个能正常工作。可以通常使用括号来改进：
> 
> #define SQUARE(X)  ((X)*(X)) 
> 
> 但仍存在这样的问题，即宏不能按值传递





## 引用变量

## 默认参数

## 函数重载

## 函数模板

## 
